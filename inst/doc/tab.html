<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Dane Van Domelen   vandomed@gmail.com" />

<meta name="date" content="2019-06-17" />

<title>Summary Tables with tab</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Summary Tables with ‘tab’</h1>
<h4 class="author"><em>Dane Van Domelen <br> <a href="mailto:vandomed@gmail.com">vandomed@gmail.com</a></em></h4>
<h4 class="date"><em>2019-06-17</em></h4>



<div id="functions" class="section level2">
<h2>Functions</h2>
<p>The purpose of <strong>tab</strong> is to make it easier to create tables for papers, including Table 1’s showing characteristics of the sample and summary tables for fitted regression models. Currently, the following functions are included:</p>
<ul>
<li><code>tabmeans</code> compares means in two or more groups.</li>
<li><code>tabmedians</code> compares medians in two or more groups.</li>
<li><code>tabfreq</code> compares frequencies in two or more groups.</li>
<li><code>tabmulti</code> compares multiple variables in two or more groups.</li>
<li><code>tabmeans.svy</code>, <code>tabmedians.svy</code>, <code>tabfreq.svy</code>, and <code>tabmulti.svy</code> serve the same purposes as the above functions, but for complex survey data.</li>
<li><code>tabglm</code> summarizes generalized linear models (GLM’s) fit via <code>glm</code> or <code>survey::svyglm</code>.</li>
<li><code>tabgee</code> summarizes generalized estimating equation models (GEE’s) fit via <code>gee::gee</code>.</li>
<li><code>tabcoxph</code> summarizes Cox Proportional Hazards models fit via <code>survival::coxph</code> or <code>survey::svycoxph</code>.</li>
</ul>
</div>
<div id="table-1s" class="section level2">
<h2>Table 1’s</h2>
<!-- A toy dataset called `tabdata` is included in **tab** package. It is a data frame with 15 variables and 300 observations. Let's take a look: -->
<!-- ```{r toydata} -->
<!-- library("tab") -->
<!-- head(tabdata) -->
<!-- ``` -->
<p>You can use <code>tabmulti</code> to compare characteristics across levels of a factor variable, e.g. here comparing age, sex, and race by treatment group in the toy dataset <code>tabdata</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tabmulti</span>(Age <span class="op">+</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Race <span class="op">~</span><span class="st"> </span>Group, <span class="dt">data =</span> tabdata) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Control</th>
<th align="left">Treatment</th>
<th align="left">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age, M (SD)</td>
<td align="left">70.5 (5.3)</td>
<td align="left">69.5 (5.9)</td>
<td align="left">0.15</td>
</tr>
<tr class="even">
<td align="left">Sex, n (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">   Female</td>
<td align="left">93 (68.4)</td>
<td align="left">62 (38.5)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   Male</td>
<td align="left">43 (31.6)</td>
<td align="left">99 (61.5)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Race, n (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.29</td>
</tr>
<tr class="even">
<td align="left">   White</td>
<td align="left">46 (34.1)</td>
<td align="left">65 (39.6)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   Black</td>
<td align="left">36 (26.7)</td>
<td align="left">52 (31.7)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   Mexican American</td>
<td align="left">21 (15.6)</td>
<td align="left">19 (11.6)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   Other</td>
<td align="left">32 (23.7)</td>
<td align="left">28 (17.1)</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>To illustrate some options, we can request <code>Age</code> and <code>Race</code> to print as <code>Age (years)</code> and <code>Race/ethnicity</code>, compare medians rather than means for age, and include the sample sizes in the column headings:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tabmulti</span>(Age <span class="op">+</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Race <span class="op">~</span><span class="st"> </span>Group, <span class="dt">data =</span> tabdata, 
         <span class="dt">yvarlabels =</span> <span class="kw">list</span>(<span class="dt">Age =</span> <span class="st">&quot;Age (years)&quot;</span>, <span class="dt">Race =</span> <span class="st">&quot;Race/ethnicity&quot;</span>), 
         <span class="dt">ymeasures =</span> <span class="kw">c</span>(<span class="st">&quot;median&quot;</span>, <span class="st">&quot;freq&quot;</span>, <span class="st">&quot;freq&quot;</span>), 
         <span class="dt">listwise.deletion =</span> <span class="ot">TRUE</span>, 
         <span class="dt">n.headings =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Control (n = 134)</th>
<th align="left">Treatment (n = 158)</th>
<th align="left">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age (years), Median (IQR)</td>
<td align="left">70.0 (9.8)</td>
<td align="left">69.0 (11.0)</td>
<td align="left">0.19</td>
</tr>
<tr class="even">
<td align="left">Sex, n (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">   Female</td>
<td align="left">92 (68.7)</td>
<td align="left">60 (38.0)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   Male</td>
<td align="left">42 (31.3)</td>
<td align="left">98 (62.0)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Race/ethnicity, n (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.26</td>
</tr>
<tr class="even">
<td align="left">   White</td>
<td align="left">46 (34.3)</td>
<td align="left">64 (40.5)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   Black</td>
<td align="left">36 (26.9)</td>
<td align="left">50 (31.6)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   Mexican American</td>
<td align="left">21 (15.7)</td>
<td align="left">17 (10.8)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   Other</td>
<td align="left">31 (23.1)</td>
<td align="left">27 (17.1)</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div id="regression-tables" class="section level2">
<h2>Regression tables</h2>
<div id="glms" class="section level4">
<h4>GLM’s</h4>
<p>Logistic regression for 1-year mortality vs. age, sex, and treatment, with the binary factor variables displayed in a “compressed” format:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw">glm</span>(death_1yr <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Group, <span class="dt">data =</span> tabdata, <span class="dt">family =</span> binomial)
fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tabglm</span>(<span class="dt">factor.compression =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Beta (SE)</th>
<th align="left">OR (95% CI)</th>
<th align="left">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="left">-2.02 (1.76)</td>
<td align="left">-</td>
<td align="left">0.25</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="left">0.02 (0.02)</td>
<td align="left">1.02 (0.97, 1.07)</td>
<td align="left">0.50</td>
</tr>
<tr class="odd">
<td align="left">Male</td>
<td align="left">0.11 (0.29)</td>
<td align="left">1.12 (0.63, 1.97)</td>
<td align="left">0.70</td>
</tr>
<tr class="even">
<td align="left">Treatment</td>
<td align="left">-0.04 (0.29)</td>
<td align="left">0.96 (0.54, 1.69)</td>
<td align="left">0.88</td>
</tr>
</tbody>
</table>
</div>
<div id="gees" class="section level4">
<h4>GEE’s</h4>
<p>GEE for high blood pressure (measured at 3 time points longitudinally) vs. various predictors, with some higher-order terms:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tabdata2 &lt;-<span class="st"> </span><span class="kw">reshape</span>(<span class="dt">data =</span> tabdata,
                    <span class="dt">varying =</span> <span class="kw">c</span>(<span class="st">&quot;bp.1&quot;</span>, <span class="st">&quot;bp.2&quot;</span>, <span class="st">&quot;bp.3&quot;</span>, <span class="st">&quot;highbp.1&quot;</span>, <span class="st">&quot;highbp.2&quot;</span>, <span class="st">&quot;highbp.3&quot;</span>),
                    <span class="dt">timevar =</span> <span class="st">&quot;bp.visit&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;long&quot;</span>)
tabdata2 &lt;-<span class="st"> </span>tabdata2[<span class="kw">order</span>(tabdata2<span class="op">$</span>id), ]
fit &lt;-<span class="st"> </span><span class="kw">gee</span>(highbp <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(Age, <span class="dv">2</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Race <span class="op">+</span><span class="st"> </span>Race<span class="op">*</span>Sex,
           <span class="dt">id =</span> id, <span class="dt">data =</span> tabdata2, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="dt">corstr =</span> <span class="st">&quot;unstructured&quot;</span>)
fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tabgee</span>(<span class="dt">data =</span> tabdata2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Beta (SE)</th>
<th align="left">OR (95% CI)</th>
<th align="left">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="left">-3.10 (14.84)</td>
<td align="left">-</td>
<td align="left">0.83</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="left">0.06 (0.43)</td>
<td align="left">1.06 (0.46, 2.45)</td>
<td align="left">0.89</td>
</tr>
<tr class="odd">
<td align="left">Age squared</td>
<td align="left">-0.00 (0.00)</td>
<td align="left">1.00 (0.99, 1.01)</td>
<td align="left">0.88</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   Female (ref)</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">   Male</td>
<td align="left">0.48 (0.29)</td>
<td align="left">1.61 (0.91, 2.84)</td>
<td align="left">0.10</td>
</tr>
<tr class="odd">
<td align="left">Race</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   White (ref)</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left">   Black</td>
<td align="left">0.04 (0.32)</td>
<td align="left">1.04 (0.56, 1.95)</td>
<td align="left">0.90</td>
</tr>
<tr class="even">
<td align="left">   Mexican American</td>
<td align="left">0.13 (0.38)</td>
<td align="left">1.14 (0.55, 2.39)</td>
<td align="left">0.72</td>
</tr>
<tr class="odd">
<td align="left">   Other</td>
<td align="left">-0.83 (0.37)</td>
<td align="left">0.43 (0.21, 0.89)</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td align="left">Sex by Race</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   Male, Black</td>
<td align="left">0.23 (0.42)</td>
<td align="left">1.26 (0.55, 2.87)</td>
<td align="left">0.58</td>
</tr>
<tr class="even">
<td align="left">   Male, Mexican American</td>
<td align="left">0.27 (0.54)</td>
<td align="left">1.31 (0.46, 3.75)</td>
<td align="left">0.61</td>
</tr>
<tr class="odd">
<td align="left">   Male, Other</td>
<td align="left">1.11 (0.51)</td>
<td align="left">3.05 (1.12, 8.25)</td>
<td align="left">0.03</td>
</tr>
</tbody>
</table>
<p>Note that we had to set <code>data = tabdata2</code> here, because <code>gee</code> objects don’t store all of the information on factor variables (unlike <code>glm</code> objects).</p>
</div>
<div id="cox-proportional-hazards" class="section level4">
<h4>Cox proportional hazards</h4>
<p>Survival model for mortality vs. predictors, again compressing the factor variables, and requesting slightly differnet columns (i.e. no p-values):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;survival&quot;</span>)
fit &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(<span class="dt">time =</span> time, <span class="dt">event =</span> delta) <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Group, <span class="dt">data =</span> tabdata)
fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tabcoxph</span>(<span class="dt">factor.compression =</span> <span class="dv">5</span>, <span class="dt">columns =</span> <span class="kw">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;hr.ci&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Beta</th>
<th align="left">HR (95% CI)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age</td>
<td align="left">0.03</td>
<td align="left">1.03 (1.00, 1.06)</td>
</tr>
<tr class="even">
<td align="left">Male</td>
<td align="left">0.01</td>
<td align="left">1.01 (0.74, 1.39)</td>
</tr>
<tr class="odd">
<td align="left">Treatment</td>
<td align="left">-0.05</td>
<td align="left">0.95 (0.69, 1.30)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="complex-survey-data" class="section level2">
<h2>Complex survey data</h2>
<p>The functions in <strong>tab</strong> can also accommodate complex survey data. To illustrate with the included dataset <code>tabsvydata</code> (which is data from NHANES 2003-2004, except for the made-up variables <code>time</code> and <code>event</code>), here’s a Table 1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;survey&quot;</span>)
design &lt;-<span class="st"> </span><span class="kw">svydesign</span>(
  <span class="dt">data =</span> tabsvydata,
  <span class="dt">ids =</span> <span class="op">~</span>sdmvpsu,
  <span class="dt">strata =</span> <span class="op">~</span>sdmvstra,
  <span class="dt">weights =</span> <span class="op">~</span>wtmec2yr,
  <span class="dt">nest =</span> <span class="ot">TRUE</span>
)
<span class="kw">tabmulti.svy</span>(Age <span class="op">+</span><span class="st"> </span>Race <span class="op">+</span><span class="st"> </span>BMI <span class="op">~</span><span class="st"> </span>Sex, <span class="dt">design =</span> design) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Female</th>
<th align="left">Male</th>
<th align="left">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age, M (SD)</td>
<td align="left">37.0 (22.5)</td>
<td align="left">34.8 (21.7)</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">Race, % (SE)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.08</td>
</tr>
<tr class="odd">
<td align="left">   Non-Hispanic White</td>
<td align="left">69.7 (3.7)</td>
<td align="left">69.6 (3.8)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   Non-Hispanic Black</td>
<td align="left">13.2 (2.0)</td>
<td align="left">11.9 (1.9)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">   Mexican American</td>
<td align="left">8.6 (2.1)</td>
<td align="left">9.8 (2.2)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">   Other</td>
<td align="left">8.4 (1.0)</td>
<td align="left">8.8 (1.3)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">BMI, M (SD)</td>
<td align="left">26.4 (7.5)</td>
<td align="left">26.0 (6.4)</td>
<td align="left">0.11</td>
</tr>
</tbody>
</table>
<p>And here’s a linear regression:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw">svyglm</span>(BMI <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Race, <span class="dt">design =</span> design)
fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tabglm</span>(<span class="dt">factor.compression =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Beta (SE)</th>
<th align="left">95% CI</th>
<th align="left">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="left">20.95 (0.34)</td>
<td align="left">(20.27, 21.62)</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="left">0.14 (0.00)</td>
<td align="left">(0.13, 0.15)</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">Female (ref)</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">Male</td>
<td align="left">-0.07 (0.23)</td>
<td align="left">(-0.51, 0.37)</td>
<td align="left">0.76</td>
</tr>
<tr class="odd">
<td align="left">Non-Hispanic White (ref)</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">Non-Hispanic Black</td>
<td align="left">1.91 (0.23)</td>
<td align="left">(1.46, 2.35)</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">Mexican American</td>
<td align="left">1.06 (0.30)</td>
<td align="left">(0.47, 1.66)</td>
<td align="left">0.006</td>
</tr>
<tr class="even">
<td align="left">Other</td>
<td align="left">-1.09 (0.33)</td>
<td align="left">(-1.73, -0.45)</td>
<td align="left">0.007</td>
</tr>
</tbody>
</table>
</div>
<div id="exporting-tables-e.g.to-word" class="section level2">
<h2>Exporting tables, e.g. to Word</h2>
<p>All of the functions in <strong>tab</strong> have an argument called <code>print.html</code> which can be used to export tables to word processors. Setting <code>print.html = TRUE</code> will result in a HTML table being output to your current working directory. You can open the table (e.g. in Chrome) and copy/paste into your report.</p>
</div>
<div id="options-for-printing-in-r" class="section level2">
<h2>Options for printing in R</h2>
<p>I used <strong>knitr</strong>’s <code>kable</code> function for the examples here, but other approaches should also work (e.g. <strong>xtable</strong>’s <code>xtable</code> or <strong>pandoc</strong>’s <code>pandoc.table</code>).</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-survey">
<p>Lumley, Thomas. 2019. <em>Survey: Analysis of Complex Survey Samples</em>. <a href="https://CRAN.R-project.org/package=survey" class="uri">https://CRAN.R-project.org/package=survey</a>.</p>
</div>
<div id="ref-survey-paper">
<p>Lumley, Thomas, and others. 2004. “Analysis of Complex Survey Samples.” <em>Journal of Statistical Software</em> 9 (1): 1–19.</p>
</div>
<div id="ref-gee">
<p>R by Thomas Lumley, Vincent J Carey. Ported to, and Brian Ripley. Note that maintainers are not available to give advice on using a package they did not author. 2015. <em>Gee: Generalized Estimation Equation Solver</em>. <a href="https://CRAN.R-project.org/package=gee" class="uri">https://CRAN.R-project.org/package=gee</a>.</p>
</div>
<div id="ref-survival-book">
<p>Terry M. Therneau, and Patricia M. Grambsch. 2000. <em>Modeling Survival Data: Extending the Cox Model</em>. New York: Springer.</p>
</div>
<div id="ref-survival-package">
<p>Therneau, Terry M. 2015. <em>A Package for Survival Analysis in S</em>. <a href="https://CRAN.R-project.org/package=survival" class="uri">https://CRAN.R-project.org/package=survival</a>.</p>
</div>
<div id="ref-knitr3">
<p>Xie, Yihui. 2014. “Knitr: A Comprehensive Tool for Reproducible Research in R.” In <em>Implementing Reproducible Computational Research</em>, edited by Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman; Hall/CRC. <a href="http://www.crcpress.com/product/isbn/9781466561595" class="uri">http://www.crcpress.com/product/isbn/9781466561595</a>.</p>
</div>
<div id="ref-knitr2">
<p>———. 2015. <em>Dynamic Documents with R and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://yihui.name/knitr/" class="uri">https://yihui.name/knitr/</a>.</p>
</div>
<div id="ref-knitr1">
<p>———. 2018. <em>Knitr: A General-Purpose Package for Dynamic Report Generation in R</em>. <a href="https://yihui.name/knitr/" class="uri">https://yihui.name/knitr/</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
